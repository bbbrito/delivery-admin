!function(){"use strict";function e(e,t){var a=t.$get();e.preferredLanguage("pt_BR"),e.useSanitizeValueStrategy("escape"),e.useStaticFilesLoader({prefix:"app/_resources/locale-",suffix:".json?r="+(a.rev||"")})}e.$inject=["$translateProvider","$windowProvider"],angular.module("app",["ngStorage","ngMessages","ngMap","pascalprecht.translate","chart.js","idf.br-filters","ui.router","ui.bootstrap","ui.utils.masks","app.generic","app.couriers","app.customers","app.dashboard","app.freights","app.orders","app.products","app.referencePoints","templates"]).config(e)}(),function(){"use strict";angular.module("templates",[])}(),function(){"use strict";angular.module("app.generic",[])}(),function(){"use strict";angular.module("app.couriers",[])}(),function(){"use strict";angular.module("app.customers",[])}(),function(){"use strict";angular.module("app.dashboard",[])}(),function(){"use strict";angular.module("app.freights",[])}(),function(){"use strict";angular.module("app.orders",[])}(),function(){"use strict";angular.module("app.products",[])}(),function(){"use strict";angular.module("app.referencePoints",[])}(),angular.module("templates").run(["$templateCache",function(e){e.put("/_layout/header.html",'<header class="header"><a class="pull-left sidebar-button" data-ng-click="toggleMenu($event)"><i class="fa fa-bars" aria-hidden="true"></i></a><h1>{{ state.current.data.title }}</h1></header>\x3c!-- .header --\x3e'),e.put("/_layout/layout.html",'<app-notification class="alert-fixed"></app-notification><aside class="sidebar {{ $root.isOpenMenu ? \'is-open\' : \'is-closed\'}}"><div class="sidebar-full" data-ng-include="\'/_layout/sidebar.html\'"></div></aside>\x3c!-- .sidebar --\x3e<main class="main {{ $root.isOpenMenu ? \'is-open\' : \'is-closed\'}}" data-ng-click="closeMenu($event)"><div data-ng-include="\'/_layout/header.html\'"></div><p class="alert alert-success" data-ng-if="vm.alert"><strong>Success!</strong> Indicates a successful or positive action.</p><article class="content" data-ui-view id="view"></article></main>\x3c!-- .main --\x3e'),e.put("/_layout/sidebar.html",'<a class="sidebar-image-wrapper logo" data-ui-sref="app.dashboard" href="#/dashboard"><img src="/assets/images/logo-strudel-folhadinho.png" alt="Strudel Folhadinho"></a><ul class="sidebar-nav"><li class="sidebar-item"><a data-ng-class="{\'is-active\': state.current.name.includes(\'app.dashboard\')}" data-ui-sref="app.dashboard" href="#/dashboard" class="sidebar-link"><span class="sidebar-icon"><i class="fa fa-home" aria-hidden="true"></i> </span><span class="sidebar-text">Home</span></a></li><li class="sidebar-item"><a data-ng-class="{\'is-active\': state.current.name.includes(\'app.customer\')}" href="#/customers" data-ui-sref="app.customers" class="sidebar-link"><span class="sidebar-icon"><i class="fa fa-users" aria-hidden="true"></i> </span><span class="sidebar-text">Clientes</span></a></li><li class="sidebar-item"><a data-ng-class="{\'is-active\': state.current.name.includes(\'app.product\')}" data-ui-sref="app.products" href="#/products" class="sidebar-link"><span class="sidebar-icon"><i class="fa fa-shopping-bag" aria-hidden="true"></i> </span><span class="sidebar-text">Produtos</span></a></li><li class="sidebar-item"><a data-ng-class="{\'is-active\': state.current.name.includes(\'app.order\')}" data-ui-sref="app.orders" href="#/orders" class="sidebar-link"><span class="sidebar-icon"><i class="fa fa-shopping-cart" aria-hidden="true"></i> </span><span class="sidebar-text">Pedidos</span></a></li><li class="sidebar-item"><a data-ng-class="{\'is-active\': state.current.name == \'app.map\'}" data-ui-sref="app.map" href="#/map" class="sidebar-link"><span class="sidebar-icon"><i class="fa fa-map-marker" aria-hidden="true"></i> </span><span class="sidebar-text">Mapa</span></a></li><li data-ng-class="{\'is-active\': state.current.name.includes(\'app.referencePoints\') || vm.referencePointsMenu}" class="sidebar-item"><a data-ng-click="vm.referencePointsMenu = !vm.referencePointsMenu" class="sidebar-link"><span class="sidebar-icon"><i class="fa fa-map-pin" aria-hidden="true"></i> </span><span class="sidebar-text">CEP</span> <span class="sidebar-arrow"><i class="fa fa-caret-down" aria-hidden="true"></i></span></a><ul class="sidebar-subnav"><li class="sidebar-item"><a data-ng-class="{\'is-active\': state.current.name.includes(\'app.freights\')}" data-ui-sref="app.freights" href="#/freights" class="sidebar-sublink"><span class="sidebar-sublink-text">Frete</span></a></li><li class="sidebar-item"><a data-ng-class="{\'is-active\': state.current.name.includes(\'app.referencePoints\')}" data-ui-sref="app.referencePoints" href="#/referencePoints" class="sidebar-sublink"><span class="sidebar-sublink-text">Pontos de Ref.</span></a></li></ul></li><li class="sidebar-item"><a data-ng-class="{\'is-active\': state.current.name == \'app.courier\'}" data-ui-sref="app.couriers" href="#/couriers" class="sidebar-link"><span class="sidebar-icon"><i class="fa fa-motorcycle" aria-hidden="true"></i> </span><span class="sidebar-text">Entregadores</span></a></li></ul>'),e.put("/couriers/form.html",'<form name="vm.courier" ng-submit="vm.save(vm.data)"><fieldset class="row"><div class="col-md-3 col-sm-6 col-xs-6 form-group"><label>Nome *</label> <input type="text" name="givenName" class="form-control" placeholder="Nome do Entregador" size="50" autocomplete="off" required ng-model="vm.data.givenName" ng-minlength="3" maxlength="50"></div></fieldset><fieldset class="row"><div class="col-md-12"><input type="submit" ng-disabled="vm.courier.$invalid" class="btn btn-primary" value="Salvar"></div></fieldset></form>'),e.put("/couriers/list.html",'<form name="vm.form" class="search-form" role="search" ng-submit="state.go(state.current.name, { q: vm.q })" novalidate><div class="input-group"><input type="text" id="search-input" placeholder="Telefone, email ou nome" autocomplete="off" name="search" ng-model="vm.q" class="form-control"> <span class="input-group-btn"><button class="btn btn-primary" type="submit" ng-disabled="vm.form.$invalid"><i class="fa fa-search" aria-hidden="true"></i></button></span></div></form><button class="btn btn-secondary" ng-click="state.go(\'app.courier\')">+ Novo</button><p ng-if="!vm.data.items.length">Nenhum entregador encontrado</p><table class="table" ng-if="vm.data.items.length"><thead><tr><th>Nome</th><th></th></tr></thead><tbody><tr class="pointer" ng-repeat="item in vm.data.items"><td ng-click="state.go(\'app.courier\', { id: item._id })">{{ item.givenName }}</td><td><i class="fa fa-trash" ng-click="vm.remove($event, item)"></i></td></tr></tbody></table><p ng-if="vm.data._metadata.total"><b>Total:</b> {{ vm.data._metadata.total }}</p><ul uib-pagination previous-text="&lsaquo;" next-text="&rsaquo;" last-text="&raquo;" force-ellipses="true" max-size="5" items-per-page="vm.data._metadata.perPage" total-items="vm.data._metadata.total" ng-if="vm.data._metadata.total > vm.data._metadata.perPage" ng-model="vm.data._metadata.page" ng-change="state.go(state.current, { page: vm.data._metadata.page })"></ul>'),e.put("/customers/fields.html",'<fieldset class="row"><div class="col-md-3 col-sm-6 col-xs-6 form-group"><label>Nome *</label> <input type="text" name="givenName" class="form-control" placeholder="Nome do Cliente" size="50" autocomplete="off" required ng-model="vm.customer.givenName" ng-minlength="3" maxlength="50"></div><div class="col-md-3 col-sm-6 col-xs-6 form-group"><label>Sobrenome</label> <input type="text" name="familyName" class="form-control" placeholder="Sobrenome do Cliente" size="50" autocomplete="off" ng-model="vm.customer.familyName" ng-minlength="3" maxlength="50"></div><div class="col-md-3 col-sm-6 col-xs-12 form-group"><label>Telefone</label> <input type="tel" name="telephone" class="form-control" size="11" autocomplete="off" ui-br-phone-number ng-model="vm.customer.telephone" maxlength="15"></div>\x3c!--\n  <div class="col-md-3 col-sm-6 form-group">\n    <label>CPF</label>\n    <input\n        type="text"\n        name="cpf"\n        class="form-control"\n        placeholder="Ex: 000.000.000-00"\n        size="50"\n        autocomplete="off"\n        ui-br-cpf-mask\n        ng-model="vm.customer.cpf"\n        maxlength="25">\n  </div>\n  <div class="col-md-2 col-sm-6 form-group">\n    <label>Apelido</label>\n    <input\n        type="text"\n        name="nickName"\n        class="form-control"\n        placeholder="Apelido do Cliente"\n        size="50"\n        autocomplete="off"\n        ng-model="vm.customer.nickName"\n        ng-minlength="3"\n        maxlength="50">\n  </div>\n  <div class="col-md-2 col-sm-6 form-group">\n    <label>Sexo</label>\n    <select\n        name="gender"\n        class="form-control"\n        ng-model="vm.customer.gender">\n        <option value="F">Feminino</option>\n        <option value="M">Masculino</option>\n    </select>\n  </div>\n  <div class="col-md-3 col-sm-6 form-group">\n    <label>E-mail</label>\n    <input\n        type="email"\n        name="email"\n        class="form-control"\n        placeholder="Ex: cliente@tegustaempanadas.com.br"\n        size="100"\n        autocomplete="off"\n        ng-model="vm.customer.email"\n        ng-minlength="3"\n        maxlength="100">\n  </div>\n  <div class="col-md-2 col-sm-6 form-group">\n    <label>Data de Nasc</label>\n\n    <input type="text" class="form-control"\n        maxlength="10"\n        uib-datepicker-popup="dd/MM/yyyy"\n        ng-model="vm.customer.birthDate"\n        is-open="birthDate.opened"\n        datepicker-options="vm.dateOptions"\n        close-text="Fechar"\n        show-button-bar="false"\n        ng-focus="birthDate.opened = true" />\n  </div>\n--\x3e</fieldset><fieldset class="row"><legend class="col-md-12 col-sm-12">Endereço de entrega</legend><div class="col-md-2 col-sm-6 col-xs-12 form-group"><label>CEP</label> <input type="tel" name="address[postalCode]" class="form-control" size="9" autocomplete="off" ui-br-cep-mask ng-model="vm.customer.address.postalCode" ng-minlength="9" ng-keyup="vm.findByPostalCode(vm.customer.address.postalCode)" ng-blur="vm.findByPostalCode(vm.customer.address.postalCode)" maxlength="9"></div><div class="col-md-5 col-sm-6 col-xs-12 form-group"><label>Rua</label> <input type="text" name="address[streetAddress]" class="form-control" size="100" autocomplete="off" ng-model="vm.customer.address.streetAddress" ng-minlength="3" ng-disabled="vm.disableAddressFields" maxlength="100"></div><div class="col-md-2 col-sm-6 col-xs-6 form-group"><label>Número</label> <input type="tel" name="address[number]" class="form-control" size="100" autocomplete="off" ng-model="vm.customer.address.number" ng-blur="vm.findReferencePoint(vm.customer.address)" placeholder="Ex: 206" maxlength="100"></div><div class="col-md-3 col-sm-6 col-xs-6 form-group"><label>Complemento</label> <input type="text" name="address[complement]" class="form-control" size="50" autocomplete="off" placeholder="Ex: ap 51 bloco A" ng-model="vm.customer.address.complement" maxlength="50"></div><div class="col-md-3 col-sm-6 col-xs-6 form-group"><label>Estado</label> <select name="addressRegion" class="form-control" name="address[addressRegion]" ng-model="vm.customer.address.addressRegion" ng-disabled="vm.disableAddressFields" required><option value="AC">Acre</option><option value="AL">Alagoas</option><option value="AP">Amapá</option><option value="AM">Amazonas</option><option value="BA">Bahia</option><option value="CE">Ceará</option><option value="DF">Distrito Federal</option><option value="ES">Espirito Santo</option><option value="GO">Goiás</option><option value="MA">Maranhão</option><option value="MS">Mato Grosso do Sul</option><option value="MT">Mato Grosso</option><option value="MG">Minas Gerais</option><option value="PA">Pará</option><option value="PB">Paraíba</option><option value="PR">Paraná</option><option value="PE">Pernambuco</option><option value="PI">Piauí</option><option value="RJ">Rio de Janeiro</option><option value="RN">Rio Grande do Norte</option><option value="RS">Rio Grande do Sul</option><option value="RO">Rondônia</option><option value="RR">Roraima</option><option value="SC">Santa Catarina</option><option value="SP">São Paulo</option><option value="SE">Sergipe</option><option value="TO">Tocantins</option></select></div><div class="col-md-3 col-sm-6 col-xs-6 form-group"><label>Cidade</label> <input type="text" name="address[district]" class="form-control" size="100" autocomplete="off" ng-model="vm.customer.address.district" ng-minlength="3" ng-disabled="vm.disableAddressFields" value="São Paulo" maxlength="100"></div><div class="col-md-3 col-sm-6 col-xs-12 form-group"><label>Bairro</label> <input type="text" name="address[addressLocality]" class="form-control" size="100" autocomplete="off" ng-model="vm.customer.address.addressLocality" ng-minlength="3" ng-disabled="vm.disableAddressFields" maxlength="100"></div><div class="col-md-3 col-sm-6 col-xs-12 form-group"><label>Referência</label> <input type="text" name="address[referencePoint]" class="form-control" size="50" autocomplete="off" ng-model="vm.customer.address.referencePoint" maxlength="50"></div></fieldset>'),e.put("/customers/form.html",'<form name="vm.customerForm" ng-submit="vm.saveCustomer(vm.customer)"><div ng-include="\'/customers/fields.html\'"></div><fieldset class="row"><div class="col-md-12"><input type="submit" ng-disabled="vm.customerForm.$invalid" class="btn btn-primary" value="Salvar"></div></fieldset></form><form name="vm.orderForm" ng-submit="vm.saveOrder(vm.customer, vm.order, vm.items, vm.gifts)"><fieldset class="row"><div class="col-md-6 col-sm-6" ng-include="\'/orders/fields.html\'"></div><div class="col-md-6 col-sm-6 order-map" ng-include="\'/orders/map.html\'" ng-if="vm.markers[0].position[0]"></div></fieldset><div ng-include="\'/orders/delivery.fields.html\'"></div><fieldset class="row"><div class="col-md-12"><input type="submit" ng-disabled="vm.orderForm.$invalid" class="btn btn-primary" value="Salvar e Imprimir"></div></fieldset></form><div ng-include="\'/orders/print.html\'"></div>'),e.put("/customers/list.html",'<form name="vm.searchCustomerForm" class="search-form" role="search" ng-submit="state.go(state.current.name, { q: vm.q })" novalidate><div class="input-group"><input type="text" id="search-input" placeholder="Telefone, email ou nome" autocomplete="off" name="search" ng-model="vm.q" class="form-control"> <span class="input-group-btn"><button class="btn btn-primary" type="submit" ng-disabled="vm.searchCustomerForm.$invalid"><i class="fa fa-search" aria-hidden="true"></i></button></span></div></form><button class="btn btn-secondary" ng-click="state.go(\'app.customer\')">+ Novo</button><p ng-if="!vm.data.items.length">Nenhum cliente encontrado</p><table class="table" ng-if="vm.data.items.length"><thead><tr><td>Nome</td><td class="hidden-xs">Telefones</td><td>Bairro</td><td></td></tr></thead><tbody><tr class="pointer" ng-repeat="customer in vm.data.items"><td ng-click="state.go(\'app.customer\', { id: customer._id })">{{ customer.givenName }}</td><td class="hidden-xs" ng-click="state.go(\'app.customer\', { id: customer._id })">{{ customer.telephone | brPhoneNumber }}</td><td ng-click="state.go(\'app.customer\', { id: customer._id })">{{ customer.address.addressLocality }}</td><td><i class="fa fa-trash" ng-click="vm.remove($event, customer)"></i></td></tr></tbody></table><p ng-if="vm.data._metadata.total"><b>Total:</b> {{ vm.data._metadata.total }}</p><ul uib-pagination previous-text="&lsaquo;" next-text="&rsaquo;" last-text="&raquo;" force-ellipses="true" max-size="5" items-per-page="vm.data._metadata.perPage" total-items="vm.data._metadata.total" ng-if="vm.data._metadata.total > vm.data._metadata.perPage" ng-model="vm.data._metadata.page" ng-change="state.go(state.current, { page: vm.data._metadata.page })"></ul>'),e.put("/dashboard/dashboard.html",'<div class="row"><div class="col-md-6"><h2>Pedidos da semana</h2><canvas id="bar" class="chart chart-bar" chart-data="vm.data" chart-labels="vm.labels" chart-series="vm.series"></canvas></div><div class="col-md-6"><h2>Total</h2><canvas id="bar" class="chart chart-bar" chart-data="vm.total" chart-labels="vm.totalLabels" chart-series="vm.totalSeries"></canvas></div></div>\x3c!-- .row --\x3e<div class="row"><div class="col-md-6"><h2>Por sabor</h2><table class="table responsive"><thead><tr><th>Sabor</th><th>Quantidade</th></tr></thead><tbody><tr ng-repeat="product in vm.byProduct"><td>{{ product._id }}</td><td>{{ product.count }}</td></tr></tbody></table></div><div class="col-md-6"><h2>Últimos pedidos</h2><a href="#/map" data-ui-sref="app.map({ size: 50 })">Pedidos</a></div></div>\x3c!-- .row --\x3e'),e.put("/freights/form.html",'<form name="vm.freightForm" ng-submit="vm.save(vm.freight)"><fieldset class="row"><div class="col-md-4 col-sm-6 form-group"><label>Bairro ou Cidade</label> <input type="text" name="addressLocality" class="form-control" placeholder="Ex: Osasco" autocomplete="off" required ng-model="vm.freight.addressLocality" ng-keyup="vm.freight.addressLocality=vm.freight.addressLocality.toUpperCase()"></div><div class="col-md-4 col-sm-6 form-group"><label>Valor</label> <input type="tel" name="price" class="form-control" placeholder="Ex: R$ 5,00" autocomplete="off" required ng-model="vm.freight.price" ui-money-mask></div></fieldset><fieldset class="row"><div class="col-md-12"><input type="submit" ng-disabled="vm.freightForm.$invalid" class="btn btn-primary" value="Salvar"></div></fieldset></form>'),e.put("/freights/list.html",'<form name="vm.searchOrderForm" class="search-form" role="search" ng-submit="state.go(state.current.name, { q: vm.q })" novalidate><div class="input-group"><input type="text" id="search-input" placeholder="Bairro" autocomplete="off" name="search" ng-model="vm.q" class="form-control"> <span class="input-group-btn"><button class="btn btn-primary" type="submit" ng-disabled="vm.searchOrderForm.$invalid"><i class="fa fa-search" aria-hidden="true"></i></button></span></div></form><button class="btn btn-secondary" ng-click="state.go(\'app.freight\')">+ Novo</button><p ng-if="!vm.data.items.length">Nenhum frete cadastrado</p><table class="table" ng-if="vm.data.items.length"><thead><tr><td>Bairro</td><td>Valor</td><td></td></tr></thead><tbody><tr class="pointer" ng-repeat="freight in vm.data.items" ng-click="state.go(\'app.freight\', { id: freight._id })"><td>{{ freight.addressLocality }}</td><td>{{ freight.price | currency }}</td><td><i class="fa fa-trash" ng-click="vm.remove($event, freight)"></i></td></tr></tbody></table><p ng-if="vm.data._metadata.total"><b>Total:</b> {{ vm.data._metadata.total }}</p><ul uib-pagination previous-text="&lsaquo;" next-text="&rsaquo;" last-text="&raquo;" force-ellipses="true" max-size="5" items-per-page="vm.data._metadata.perPage" total-items="vm.data._metadata.total" ng-if="vm.data._metadata.total > vm.data._metadata.perPage" ng-model="vm.data._metadata.page" ng-change="state.go(state.current, { page: vm.data._metadata.page })"></ul>'),e.put("/orders/delivery.fields.html",'<div class="row"><div class="col-md-3 col-sm-3 col-xs-12 form-group"><label>Dia de entrega</label> <input type="text" class="form-control" uib-datepicker-popup="dd/MM/yyyy" ng-model="vm.order.delivery.date" is-open="deliveryDate.opened" datepicker-options="vm.deliveryDateOptions" ng-required="true" close-text="Fechar" show-button-bar="false" ng-focus="deliveryDate.opened = true"></div><div class="col-md-3 col-sm-3 col-xs-12 form-group"><div uib-timepicker class="timepicker" ng-model="vm.order.delivery.date" show-seconds="false" meridians="[\'AM\', \'PM\']"></div></div><div class="col-md-3 col-sm-3 col-xs-12 form-group"><label>Taxa de entrega</label> <input type="tel" class="form-control" size="50" autocomplete="off" ng-model="vm.order.delivery.price" ng-minlength="3" ui-money-mask value="5.0" max="100" maxlength="9"></div><div class="col-md-3 col-sm-3 col-xs-12 form-group"><label>Entregador</label> <select class="form-control" ng-options="item as item for item in vm.couriers" ng-model="vm.order.delivery.courier"></select></div></div><div class="row"><div class="col-md-3 col-sm-3"><label>Forma de Pagamento</label> <select class="form-control" ng-change="vm.changePaymentType(vm.order.payment)" ng-model="vm.order.payment.paymentType"><option value="DEBIT_CARD">{{ \'DEBIT_CARD\' | translate }}</option><option value="CREDIT_CARD">{{ \'CREDIT_CARD\' | translate }}</option><option value="SODEXO">{{ \'SODEXO\' | translate }}</option><option value="MONEY">{{ \'MONEY\' | translate }}</option><option value="TICKET">{{ \'TICKET\' | translate }}</option><option value="ALELO">{{ \'ALELO\' | translate }}</option></select></div><div class="col-md-3 col-sm-3 col-xs-12"><label>Desconto</label> <input type="tel" class="form-control" ui-money-mask ng-model="vm.order.payment.discount"></div><div class="col-md-3 col-sm-3 col-xs-12" ng-if="vm.order.payment.paymentType == \'MONEY\'"><label>Pago em Dinheiro</label> <input class="form-control" ui-money-mask ng-model="vm.order.payment.moneyTotal"></div><div class="col-md-3 col-sm-3 col-xs-12" ng-if="vm.order.payment.paymentType == \'MONEY\'"><label>Troco:</label><p class="form-control">{{ vm.order.payment.change = ( vm.order.payment.moneyTotal - vm.order.payment.total + vm.order.payment.discount ) | currency }}</p></div><div class="col-md-3 col-sm-3 col-xs-12"><label>Total:</label><p class="form-control">{{ vm.order.payment.total = ( vm.order.payment.subtotal + vm.order.delivery.price - vm.order.payment.discount ) | currency }}</p></div></div>\x3c!--  --\x3e'),e.put("/orders/fields.html",'<legend>Pedido</legend><div class="order-items-table"><select class="form-control" ng-model="vm.filterProducts.type"><option value="!Strudel">Empanadas</option><option value="Strudel">Strudel</option><option value="Doce">Doce</option><option value="Bebida">Bebida</option></select><table class="table" border="0" cellspacing="0" cellpadding="0"><thead><tr><th>Produto</th><th width="100">Qnt</th><th width="50">Vl unit</th><th width="90">Total</th></tr></thead><tbody><tr ng-repeat="product in vm.items | filter:vm.filterProducts"><td><label for="item-{{ $index }}">{{ product.name }}</label></td><td><input type="tel" id="item-{{ $index }}" autocomplete="off" ng-model="product.quantity" maxlength="3" ui-number-mask="0" class="form-control input-small"></td><td class="align-right">{{ product.price | currency }}</td><td><span ng-show="product.quantity">{{ product.total = ((product.quantity || 0) * product.price) | currency }}</span></td></tr></tbody><tfoot><tr><td><b>Subtotal:</b></td><td>{{ vm.items | sum:\'quantity\' }}</td><td></td><td>{{ vm.order.payment.subtotal = (vm.items | sum:\'total\') | currency }}</td></tr></tfoot></table></div><legend>Brinde</legend><div class="order-items-table"><table class="table"><thead><tr><th>Produto</th><th width="100">Qnt</th><th width="50">Vl unit</th><th width="90">Total</th></tr></thead><tbody><tr ng-repeat="product in vm.gifts | filter:{ gift: true }"><td><label for="gift-{{ $index }}">{{ product.name }}</label></td><td><input type="tel" id="gift-{{ $index }}" autocomplete="off" ng-model="product.quantity" maxlength="2" ui-number-mask="0" class="form-control input-small"></td><td>Brinde</td><td></td></tr></tbody><tfoot><tr><td><b>Subtotal:</b></td><td>{{ vm.gifts | sum:\'quantity\' }}</td><td></td><td>Grátis</td></tr></tfoot></table></div>'),e.put("/orders/form.html",'<form name="vm.orderForm" ng-submit="vm.saveOrder(vm.order, vm.customer)"><fieldset class="row"><div class="col-md-12 col-sm-12" ng-include="\'/orders/fields.html\'" ng-if="vm.order._id"></div></fieldset><fieldset class="row" ng-if="vm.order._id"><div class="col-md-12"><input type="submit" ng-disabled="vm.orderForm.$invalid" class="btn btn-primary" value="Salvar"></div></fieldset></form>'),e.put("/orders/list.html",'<form name="vm.searchOrderForm" class="search-form" role="search" ng-submit="state.go(state.current.name, { q: vm.q })" novalidate><div class="input-group"><input type="text" id="search-input" placeholder="Nome do cliente" autocomplete="off" name="search" ng-model="vm.q" class="form-control"> <span class="input-group-btn"><button class="btn btn-primary" type="submit" ng-disabled="vm.searchOrderForm.$invalid"><i class="fa fa-search" aria-hidden="true"></i></button></span></div></form><button class="btn btn-secondary" ng-click="state.go(\'app.customer\')">+ Novo</button><p ng-if="!vm.data.items.length">Nenhum pedido encontrado</p><table class="table" ng-if="vm.data.items.length"><thead><tr><th>Nome</th><th>Total</th><th>Entrega</th><th class="hidden-xs">Entregador</th><th class="hidden-xs">Bairro</th><th class="center">Pago?</th><th></th></tr></thead><tbody><tr ng-repeat="order in vm.data.items track by order._id"><td ng-click="state.go(\'app.order\', { id: order._id })" class="link">{{ order.customer.givenName }}</td><td>{{ order.payment.total | currency }}</td><td>{{ order.delivery.date | date:\'dd/MM HH:mm\' }}</td><td class="hidden-xs"><select class="form-control" ng-options="item as item for item in vm.couriers" ng-model="order.delivery.courier" ng-change="vm.save(order)"></select></td><td class="hidden-xs">{{ order.shippingAddress.addressLocality }}</td><td class="center"><i class="pointer fa {{ order.payment.payedAt ? \'fa-usd success\' : \'fa-ban danger\' }}" ng-click="vm.payed = !order.payment.payedAt; vm.save(order, vm.payed)"></i></td><td><i class="fa fa-trash" ng-click="vm.remove($event, order)"></i></td></tr></tbody></table><p ng-if="vm.data._metadata.total"><b>Total:</b> {{ vm.data._metadata.total }}</p><ul uib-pagination previous-text="&lsaquo;" next-text="&rsaquo;" last-text="&raquo;" force-ellipses="true" max-size="5" items-per-page="vm.data._metadata.perPage" total-items="vm.data._metadata.total" ng-if="vm.data._metadata.total > vm.data._metadata.perPage" ng-model="vm.data._metadata.page" ng-change="state.go(state.current, { page: vm.data._metadata.page })"></ul>'),e.put("/orders/map.html",'<div id="map" map-lazy-load="{{ vm.googleMapsUrl }}" map-lazy-load-params="{{ vm.googleMapsUrl }}"><ng-map id="ng-map" default-style="false" center="{{ vm.center }}" zoom="{{ vm.zoom }}"><marker position="{{ vm.organization.location }}" icon="{{ vm.organization.icon }}"></marker><marker ng-repeat="marker in vm.markers track by $index" position="{{ marker.position }}" label="{{ marker.label }}" icon="{{ marker.icon }}"></marker></ng-map></div>'),e.put("/orders/print.html",'<button class="btn btn-primary" ng-if="vm.print && vm.order.customer" ng-click="vm.print()">Imprimir</button><div class="row order-print" ng-if="vm.order.customer"><div class="col-md-12"><table class="order-print-table order-print-header"><tr><td>{{ \'Te Gusta Empanadas\' | uppercase }}</td></tr><tr><td>{{ \'Butantã - São Paulo\' | uppercase }}</td></tr><tr><td>{{ \'cnpj 19.062.745/0001-03\' | uppercase }}</td></tr></table><table class="order-print-table"><tr><td>&nbsp;</td></tr><tr><td><b>{{ vm.order.customer.givenName }} {{ vm.order.customer.familyName }}</b> {{ (vm.order.customer.telephone || vm.order._customer.telephone) | brPhoneNumber }}<br></td></tr><tr><td>{{ vm.order.shippingAddress.addressLocality }}</td></tr><tr><td>{{ vm.order.shippingAddress.postalCode | brCep }} - {{ vm.order.shippingAddress.district }}, {{ vm.order.shippingAddress.addressRegion }}</td></tr><tr><td>{{ vm.order.shippingAddress.streetAddress }}</td></tr><tr><td>Número: {{ vm.order.shippingAddress.number }}</td></tr><tr data-ng-if="vm.order.shippingAddress.complement"><td>{{ vm.order.shippingAddress.complement }}</td></tr><tr data-ng-if="vm.order.shippingAddress.referencePoint"><td>{{ vm.order.shippingAddress.referencePoint }}</td></tr><tr><td>&nbsp;</td></tr></table></div><div class="col-md-12"><table class="order-print-table"><tr><th width="10%">Qtd</th><th width="70%">Item</th><th width="20%" class="align-right">Preço</th></tr><tr data-ng-repeat="item in vm.order.items"><td>{{ item.quantity }}</td><td>{{ item.name }}</td><td class="align-right">{{ (item.subtotal = item.quantity * item.price) | currency }}</td></tr><tr data-ng-if="vm.order.gifts.length"><td colspan="3">&nbsp;</td></tr><tr data-ng-repeat="item in vm.order.gifts"><td>{{ item.quantity }}</td><td>{{ item.name }}</td><td class="align-right">brinde</td></tr><tr><td colspan="3">&nbsp;</td></tr><tr><td colspan="2"><b>Taxa de entrega:</b></td><td class="align-right">{{ (vm.order.delivery.price || 0) | currency }}</td></tr><tr data-ng-if="vm.order.payment.discount"><td colspan="2"><b>Desconto:</b></td><td class="align-right">{{ vm.order.payment.discount | currency }}</td></tr><tr><td><b>Total:</b></td><td>{{ (vm.order.items | sum:\'quantity\') + (vm.order.gifts | sum:\'quantity\') }}</td><td class="align-right"><b>{{ vm.order.payment.total | currency }}</b></td></tr><tr data-ng-if="vm.order.payment.change"><td><b>Troco:</b></td><td>{{ vm.order.payment.change | currency }}</td><td class="align-right">{{ vm.order.payment.moneyTotal | currency }}</td></tr><tr data-ng-if="vm.order.payment.paymentType"><td colspan="2"><b>Forma de pagamento:</b></td><td class="align-right">{{ vm.order.payment.paymentType | translate }}</td></tr><tr><td colspan="3">&nbsp;</td></tr></table></div><div class="col-md-12"><table class="order-print-table"><tr data-ng-if="vm.order.delivery.courier"><td width="40%"><b>Entregador:</b></td><td width="60%">{{ vm.order.delivery.courier }}</td></tr><tr><td><b>Data:</b></td><td class="align-right">{{ vm.order.createdAt | date:\'dd/MM/yy HH:mm\' }}</td></tr><tr><td><b>Entrega:</b></td><td class="align-right">{{ vm.order.delivery.date | date:\'dd/MM/yy HH:mm\' }}</td></tr><tr><td colspan="2">&nbsp;</td></tr></table></div></div>'),e.put("/products/form.html",'<form name="vm.productForm" ng-submit="vm.save(vm.product)"><fieldset class="row"><div class="col-md-6 col-sm-6 form-group"><label>Nome *</label> <input type="text" name="name" class="form-control" placeholder="Nome do Produto" size="50" autocomplete="off" required ng-model="vm.product.name" ng-minlength="3" maxlength="50"></div><div class="col-md-6 col-sm-6 form-group"><label>Preço *</label> <input type="tel" name="price" class="form-control" placeholder="Preço do Produto" size="50" autocomplete="off" required ng-model="vm.product.price" ui-money-mask maxlength="50"></div><div class="col-md-6 col-sm-6 form-group"><label>Tipo</label> <select name="type" class="form-control" ng-model="vm.product.type"><option value="Salgado">Salgado</option><option value="Doce">Doce</option><option value="Strudel">Strudel</option><option value="Bebida">Bebida</option></select></div><div class="col-md-6 col-sm-6 form-group"><label>Brinde</label> <input type="checkbox" name="gift" class="form-control" ng-model="vm.product.gift"></div></fieldset><fieldset class="row"><div class="col-md-12"><input type="submit" ng-disabled="vm.productForm.$invalid" class="btn btn-primary" value="Salvar"></div></fieldset></form>'),e.put("/products/list.html",'<form name="vm.searchProductForm" class="search-form" role="search" ng-submit="state.go(state.current.name, { q: vm.q })" novalidate><div class="input-group"><input type="text" id="search-input" placeholder="Nome do produto" autocomplete="off" name="search" ng-model="vm.q" class="form-control"> <span class="input-group-btn"><button class="btn btn-primary" type="submit" ng-disabled="vm.searchProductForm.$invalid"><i class="fa fa-search" aria-hidden="true"></i></button></span></div></form><button class="btn btn-secondary" ng-click="state.go(\'app.product\')">+ Novo</button><p ng-if="!vm.data.items.length">Nenhum produto encontrado</p><table class="table" ng-if="vm.data.items.length"><thead><tr><td>Nome</td><td>Preço</td><td></td></tr></thead><tbody><tr class="pointer" ng-repeat="product in vm.data.items" ng-click="state.go(\'app.product\', { id: product._id })"><td>{{ product.name }}</td><td>{{ product.price | currency }}</td><td><i class="fa fa-trash" ng-click="vm.remove($event, product)"></i></td></tr></tbody></table><p ng-if="vm.data._metadata.total"><b>Total:</b> {{ vm.data._metadata.total }}</p><ul uib-pagination previous-text="&lsaquo;" next-text="&rsaquo;" last-text="&raquo;" force-ellipses="true" max-size="5" items-per-page="vm.data._metadata.perPage" total-items="vm.data._metadata.total" ng-if="vm.data._metadata.total > vm.data._metadata.perPage" ng-model="vm.data._metadata.page" ng-change="state.go(state.current, { page: vm.data._metadata.page })"></ul>'),e.put("/referencePoints/form.html",'<form name="vm.referencePointForm" ng-submit="vm.save(vm.referencePoint)"><fieldset class="row"><div class="col-md-4 col-sm-6 form-group"><label>CEP</label> <input type="text" name="postalCode" class="form-control" placeholder="CEP" size="50" autocomplete="off" required ng-model="vm.referencePoint.postalCode" ng-minlength="3" maxlength="10"></div><div class="col-md-4 col-sm-6 form-group"><label>Número *</label> <input type="tel" name="number" class="form-control" size="50" autocomplete="off" required ng-model="vm.referencePoint.number" maxlength="50"></div><div class="col-md-4 col-sm-6 form-group"><label>Ponto de Referência</label> <input type="text" name="referencePoint" required class="form-control" ng-model="vm.referencePoint.referencePoint"></div></fieldset><fieldset class="row"><div class="col-md-12"><input type="submit" ng-disabled="vm.referencePointForm.$invalid" class="btn btn-primary" value="Salvar"></div></fieldset></form>'),e.put("/referencePoints/list.html",'<form name="vm.searchOrderForm" class="search-form" role="search" ng-submit="state.go(state.current.name, { q: vm.q })" novalidate><div class="input-group"><input type="text" id="search-input" placeholder="CEP" autocomplete="off" name="search" ng-model="vm.q" class="form-control"> <span class="input-group-btn"><button class="btn btn-primary" type="submit" ng-disabled="vm.searchOrderForm.$invalid"><i class="fa fa-search" aria-hidden="true"></i></button></span></div></form><button class="btn btn-secondary" ng-click="state.go(\'app.referencePoint\')">+ Novo</button><p ng-if="!vm.data.items.length">Nenhum ponto de referência encontrado</p><table class="table" ng-if="vm.data.items.length"><thead><tr><td>CEP</td><td>Número</td><td>Ponto de Referência</td><td></td></tr></thead><tbody><tr class="pointer" ng-repeat="referencePoint in vm.data.items" ng-click="state.go(\'app.referencePoint\', { id: referencePoint._id })"><td>{{ referencePoint.postalCode }}</td><td>{{ referencePoint.number }}</td><td>{{ referencePoint.referencePoint }}</td><td><i class="fa fa-trash" ng-click="vm.remove($event, referencePoint)"></i></td></tr></tbody></table><p ng-if="vm.data._metadata.total"><b>Total:</b> {{ vm.data._metadata.total }}</p><ul uib-pagination previous-text="&lsaquo;" next-text="&rsaquo;" last-text="&raquo;" force-ellipses="true" max-size="5" items-per-page="vm.data._metadata.perPage" total-items="vm.data._metadata.total" ng-if="vm.data._metadata.total > vm.data._metadata.perPage" ng-model="vm.data._metadata.page" ng-change="state.go(state.current, { page: vm.data._metadata.page })"></ul>')}]),function(){"use strict";function e(e,t,a){var r=e;r.toggleMenu=function(e){e.stopPropagation(),t.isOpenMenu=!t.isOpenMenu},r.closeMenu=function(){t.isOpenMenu=!1},t.isOpenMenu=!1;t.$on("$stateChangeStart",function(e,t,a){r.closeMenu()});return r}e.$inject=["$scope","$rootScope","$templateCache"],angular.module("app").controller("AppController",e)}(),function(){"use strict";function e(r,e,o,n){r.state=e;r.$on("$stateChangeStart",function(e,t,a){r.$storage=o,n.close()})}function t(e,t,a,r){t.interceptors.push("HTTPInterceptor"),a.otherwise("/dashboard"),location.port||r.debugInfoEnabled(!1),e.state("app",{data:{requireLogin:!0},abstract:!0,views:{"":{templateUrl:"/_layout/layout.html"}}}).state("app.dashboard",{url:"/dashboard",controller:"DashboardController as vm",templateUrl:"/dashboard/dashboard.html",data:{title:"Dashboard"}})}e.$inject=["$rootScope","$state","$localStorage","NotificationService"],t.$inject=["$stateProvider","$httpProvider","$urlRouterProvider","$compileProvider"],angular.module("app").run(e).config(t)}(),Pace.options.ajax.trackMethods=["GET","POST","PUT","DELETE"],function(){"use strict";function e(e,a,t,r,o){function n(e){r.list(e).then(function(e){t.data=e.data}).catch(o.error)}return t.q=e.params.q,t.remove=function(e,t){if(e.stopPropagation(),!a.confirm("Deseja excluir?"))return!1;r.remove(t._id).then(n).catch(o.error)},n({q:t.q,page:e.params.page,size:e.params.size}),t}e.$inject=["$state","$window","vm","service","NotificationService"],angular.module("app.generic").controller("GenericListController",e)}(),function(){"use strict";angular.module("app").filter("telephone",function(){return function(e){if(e)return e.replace(/^\+55\s?/,"")}}).filter("sum",function(){return function(e,a){return(e||[]).reduce(function(e,t){return t[a]?e+t[a]:e},0)}})}(),function(){"use strict";angular.module("app").directive("appNotification",function(){return{restrict:"EA",replace:(e.$inject=["$scope","$rootScope","$timeout"],!1),transclude:!0,scope:!0,template:['<div class="alert-container" ng-if="alert.display()">','<div class="alert alert-{{ alert.type }}" role="alert">',"<i class=\"fa\" ng-class=\"{ 'fa-exclamation-circle': (alert.type === 'warning' || alert.type === 'danger'), 'fa-check-circle': alert.type === 'success' }\" aria-hidden=\"true\"></i>",'<p class="alert-text"><b ng-if="alert.title">{{ alert.title | translate }} </b>{{ alert.message | translate }}</p>','<i class="fa fa-close alert-close" ng-click="alert.close()" aria-hidden="true"></i>',"</div>","</div>"].join(""),controller:e};function e(e,t,a){var r,o={type:"success",message:null,timeout:!0,display:function(){return this.isVisible},close:function(){this.isVisible=!1},notify:function(e){this.message=e.message,this.title=e.title,this.type=e.type,this.timeout=e.timeout,this.init()},init:function(){a.cancel(r),this.isVisible=!0,r=this.timeout&&!isNaN(this.timeout)&&5e3<this.timeout?a(this.close.bind(this),this.timeout):a(this.close.bind(this),5e3)}};e.alert=o;t.$on("notificationChannel",function(e,t){if("close"===t)return o.close();o.notify(t)})}})}(),function(){"use strict";angular.module("app.generic").factory("GenericService",function(){return{}})}(),function(){"use strict";function e(o,e,t,n){var s=n.defer();return this.request=function(e){return s=n.defer(),e.timeout=s.promise,e},this.response=function(e){return e},this.responseError=function(e){var t={401:"unauthorized",403:"forbidden",405:"unavailable",413:"entity_too_large",422:"unprocessable_entity",500:"unavailable",503:"unavailable",504:"unavailable"},a=String(e.status),r=t[a]?t[a]:"try_again";return/401|403|405|413|422|500|503|504/.test(a)?(s.resolve(t[a]),o.$broadcast(r,e),n.reject(r)):e},this}e.$inject=["$rootScope","$timeout","$translate","$q"],angular.module("app").factory("HTTPInterceptor",e)}(),function(){"use strict";function e(o,e){return{get:function(e,t,a){var r={url:e,params:t||{},method:"GET"};return angular.extend(r,a),o(r).then(n)},post:function(e,t,a){return o({url:e,data:t,method:"POST",headers:a||{}}).then(n)},put:function(e,t,a){return o({url:e,data:t,method:"PUT",headers:a||{}}).then(n)},delete:function(e,t){return o({url:e,method:"DELETE",headers:t||{}}).then(n)},handleError:function(e){if(400<=e.status){var t=e.data,a=new Error(t.message||"Ocorreu um erro");throw a.status=status,a}return e}}}function n(e){return angular.isString(e.data)||(e.data=e.data||{}),e}e.$inject=["$http","$httpParamSerializer"],angular.module("app").factory("HTTPService",e)}(),function(){"use strict";angular.module("app.orders").factory("MapService",function(){return{googleMapsUrl:"https://maps.googleapis.com/maps/api/js?key=AIzaSyB7BimdwO2vhjoXDyKWKkWyuzrQsA4TwgM",zoom:15,organization:{location:"-23.6024185,-46.7881249",icon:"/assets/images/organization-marker-image.png"},shape:{coords:[1,1,1,20,18,20,18,1],type:"poly"},getMarker:function(e,t){return{label:e,position:[t.lat,t.lng]}}}})}(),function(){"use strict";function e(r){function e(a){return function(e){var t={type:a,message:angular.isObject(e)?e.message:e,title:!!angular.isObject(e)&&e.title,timeout:!angular.isObject(e)||e.timeout};r.$broadcast("notificationChannel",t)}}return{success:e("success"),warning:e("warning"),error:e("danger"),info:e("info"),close:function(){r.$broadcast("notificationChannel","close")}}}e.$inject=["$rootScope"],angular.module("app").factory("NotificationService",e)}(),function(){"use strict";function e(a,r){return{findReferencePoint:function(e){var t={postalCode:e.postalCode,number:e.number};return a.get("/api/postalcodes/referencePoint",t,{cache:!0})},findByPostalCode:function(e){return a.get("/api/postalcodes/"+e,{},{cache:!0})},getLocation:function(e){if(Object.keys(e).length<3)return r.reject();var t=e.streetAddress+","+e.district+","+e.number;return a.get("https://maps.google.com/maps/api/geocode/json?address="+t+"&sensor=true",{},{cache:!0}).then(a.handleError).then(function(e){var t=e.data;return t.results[0]&&t.results[0].geometry.location})}}}e.$inject=["HTTPService","$q"],angular.module("app").factory("PostalCodeService",e)}(),function(){"use strict";function e(t){return{endpoint:"",list:function(e){return t.get("/api/"+this.endpoint,e).then(t.handleError)},byId:function(e){return t.get("/api/"+this.endpoint+"/"+e).then(t.handleError)},save:function(e){return(e._id?t.put("/api/"+this.endpoint+"/"+e._id,e):t.post("/api/"+this.endpoint,e)).then(t.handleError)},remove:function(e){return t.delete("/api/"+this.endpoint+"/"+e).then(t.handleError)}}}e.$inject=["HTTPService"],angular.module("app.generic").factory("RestService",e)}(),function(){"use strict";function e(a,t,r){var e,o=this,n=a.params.id;return t.endpoint="couriers",o.data={},o.save=function(e){t.save(e).then(function(e){var t=e.data;201===e.status&&a.go(a.current.name,{id:t._id}),r.success({title:"courier",message:"form.saved"})}).catch(r.error)},n&&(e=n,t.byId(e).then(function(e){o.data=e.data}).catch(r.error)),o}e.$inject=["$state","RestService","NotificationService"],angular.module("app.couriers").controller("CourierController",e)}(),function(){"use strict";function e(e,t,a){return a.endpoint="couriers",angular.extend(this,t("GenericListController",{vm:this,$state:e,service:a})),this}e.$inject=["$state","$controller","RestService"],angular.module("app.couriers").controller("CourierListController",e)}(),function(){"use strict";function e(e){e.state("app.couriers",{url:"/couriers?q?page?",controller:"CourierListController",controllerAs:"vm",templateUrl:"/couriers/list.html",data:{title:"Lista de Entregadores"}}).state("app.courier",{url:"/courier/:id?",controller:"CourierController",controllerAs:"vm",templateUrl:"/couriers/form.html",data:{title:"Cadastro de Entregador"}})}e.$inject=["$stateProvider"],angular.module("app.couriers").config(e)}(),function(){"use strict";function e(a,o,t,r,n,s,i,e,l,d){var c,m=this,u=a.params.id;function p(e){var t=[];return e.addressLocality&&(t=t.concat(e.addressLocality)),e.district&&(t=t.concat(e.district)),t.join(",")}function f(e){return!!e&&l.get("/api/freights/search",{locality:e}).then(l.handleError).then(function(e){var t=e.data;m.order.delivery.price=t.price})}function g(e){r.getLocation(e).then(function(e){!function(e){if(!e)return;m.markers=[d.getMarker(m.customer.givenName,e)],m.center=[e.lat,e.lng]}(m.customer.address.location=e)})}return t.endpoint="customers",l.get("/api/couriers").then(function(e){m.couriers=(e.data.items||[]).map(function(e){return e.givenName})}),m.googleMapsUrl=d.googleMapsUrl,m.zoom=14,m.organization=d.organization,m.shape=d.shape,m.customer={address:{addressRegion:"SP"}},m.filterProducts={type:"!Strudel"},m.saveCustomer=function(e){t.save(e).then(function(e){var t=e.data;201===e.status&&a.go(a.current.name,{id:t._id}),n.success({title:"customer",message:"form.saved"})}).catch(n.error)},m.saveOrder=function(e,t,a,r){i.createOrder(e,t,a,r).then(function(e){e.data;n.success({title:"order",message:"form.saved"}),o.print()}).catch(n.error)},m.findByPostalCode=function(a){if(!a||a.length<8)return m.disableAddressFields=!1;r.findByPostalCode(a).then(function(e){var t=e.data;return m.customer.address=angular.extend(m.customer.address,t),m.customer.address.postalCode=a,m.disableAddressFields=!!t.streetAddress,m.customer.address}).then(function(e){f(p(e))}).catch(function(){m.disableAddressFields=!1})},m.findReferencePoint=function(e){if(!e.postalCode||e.postalCode.length<8||!e.number)return!1;g(e),r.findReferencePoint(e).then(function(e){var t=e.data;m.customer.address=m.customer.address||{},m.customer.address.referencePoint=t.referencePoint})},m.changePaymentType=function(e){"MONEY"===e.type?e.moneyTotal=e.total:(e.moneyTotal=0,e.change=0)},m.dateOptions=s.getDateOptions(),m.deliveryDateOptions=i.getDateOptions(),u&&(c=u,t.byId(c).then(function(e){return m.customer=e.data,m.customer.birthDate=s.normalizeBirthDate(m.customer.birthDate),m.disableAddressFields=!(!m.customer.address||!m.customer.address.streetAddress),m.customer}).catch(n.error)).then(function(e){if(!e||!e.address)return!1;f(p(e.address)),g(e.address)}),e.list({attr:"items",size:50}).then(function(e){var t=e.data;m.items=t,m.gifts=angular.copy(t)}).catch(n.error),m.order={delivery:i.getDeliveryTime()},m}e.$inject=["$state","$window","RestService","PostalCodeService","NotificationService","CustomerService","OrderService","ProductService","HTTPService","MapService"],angular.module("app.customers").controller("CustomerController",e)}(),function(){"use strict";function e(e,t,a){return a.endpoint="customers",angular.extend(this,t("GenericListController",{vm:this,$state:e,service:a})),this}e.$inject=["$state","$controller","RestService"],angular.module("app.customers").controller("CustomerListController",e)}(),function(){"use strict";function e(e){e.state("app.customers",{url:"/customers?q?page?",controller:"CustomerListController",controllerAs:"vm",templateUrl:"/customers/list.html",data:{title:"Lista de Clientes"}}).state("app.customer",{url:"/customer/:id?",controller:"CustomerController",controllerAs:"vm",templateUrl:"/customers/form.html",data:{title:"Cadastro de Cliente"}})}e.$inject=["$stateProvider"],angular.module("app.customers").config(e)}(),function(){"use strict";function e(t){return{search:function(e){return t.get("/api/customers",e).then(t.handleError)},getDateOptions:function(){return{formatYear:"yy",maxDate:new Date,minDate:new Date(1900,0,1),startingDay:1,showWeeks:!1}},normalizeBirthDate:function(e){return e?new Date(e):""}}}e.$inject=["HTTPService"],angular.module("app.customers").factory("CustomerService",e)}(),function(){"use strict";function e(e,t){var a=this;return t.get("/api/reports/total").then(function(e){a.totalSeries=["Total","Mês"],a.totalLabels=e.data.map(function(e){return e._id.month+"/"+e._id.year}),a.total=e.data.map(function(e){return e.total})}),t.get("/api/reports/sales").then(function(e){a.series=["Valor","Pedidos"],a.labels=e.data.map(function(e){return e._id.replace(/([^T]+).*/,"$1")}),a.data=[],a.data[0]=e.data.map(function(e){return e.paymentTotal}),a.data[1]=e.data.map(function(e){return e.count})}),t.get("/api/reports/byProduct").then(function(e){a.byProduct=e.data}),a}e.$inject=["$rootScope","HTTPService"],angular.module("app").controller("DashboardController",e)}(),function(){"use strict";function e(a,t,r){var e,o=this,n=a.params.id;return t.endpoint="freights",o.freight={},o.save=function(e){t.save(e).then(function(e){var t=e.data;201===e.status&&a.go(a.current.name,{id:t._id}),r.success({title:"freight",message:"form.saved"})}).catch(r.error)},n&&(e=n,t.byId(e).then(function(e){o.freight=e.data}).catch(r.error)),o}e.$inject=["$state","RestService","NotificationService"],angular.module("app.freights").controller("FreightController",e)}(),function(){"use strict";function e(e,t,a){return a.endpoint="freights",angular.extend(this,t("GenericListController",{vm:this,$state:e,service:a})),this}e.$inject=["$state","$controller","RestService"],angular.module("app.freights").controller("FreightListController",e)}(),function(){"use strict";function e(e){e.state("app.freights",{url:"/freights?q?page?",controller:"FreightListController",controllerAs:"vm",templateUrl:"/freights/list.html",data:{title:"Valores de Frete"}}).state("app.freight",{url:"/freight/:id?",controller:"FreightController",controllerAs:"vm",templateUrl:"/freights/form.html",data:{title:"Cadastro de Frete"}})}e.$inject=["$stateProvider"],angular.module("app.freights").config(e)}(),function(){"use strict";function e(e,t,a,r,o,n,s){var i,l=this,d=e.params.id;return a.endpoint="orders",l.order={},l.print=function(){t.print()},d&&(i=d,a.byId(i).then(function(e){l.order=e.data,l.order.delivery&&l.order.delivery.date&&(l.order.delivery.date=s.normalizeDeliveryDate(l.order.delivery.date))}).catch(o.error)),l.dateOptions=s.getDateOptions(),l}e.$inject=["$state","$window","RestService","ProductService","NotificationService","CustomerService","OrderService"],angular.module("app.orders").controller("OrderController",e)}(),function(){"use strict";function e(e,t,a,r,o){var n=this;return n.save=function(e,t){e.payment.payedAt=t?new Date:null,a.save(e).then(function(e){e.data;o.success({title:"order",message:"form.saved"})}).catch(o.error)},a.endpoint="orders",angular.extend(n,t("GenericListController",{vm:n,$state:e,service:a})),r.get("/api/couriers").then(function(e){n.couriers=(e.data.items||[]).map(function(e){return e.givenName})}),n}e.$inject=["$state","$controller","RestService","HTTPService","NotificationService"],angular.module("app.orders").controller("OrderListController",e)}(),function(){"use strict";function e(e,t,a){var r=this;return r.googleMapsUrl=a.googleMapsUrl,r.zoom=a.zoom,r.organization=a.organization,r.center=a.organization.location,r.shape=a.shape,t.list({location:!0,size:e.params.size||10}).then(function(e){var t=e.data;r.markers=(t.items||[]).filter(function(e){return e.shippingAddress.location}).map(function(e){return a.getMarker(e.customer.givenName,e.shippingAddress.location)})}),r}e.$inject=["$state","OrderService","MapService"],angular.module("app.orders").controller("OrderMapController",e)}(),function(){"use strict";function e(e){e.state("app.orders",{url:"/orders?q?page?size?",controller:"OrderListController",controllerAs:"vm",templateUrl:"/orders/list.html",data:{title:"Lista de Pedidos"}}).state("app.map",{url:"/map?size?",controller:"OrderMapController",controllerAs:"vm",templateUrl:"/orders/map.html",data:{title:"Mapa de Entregas"}}).state("app.order",{url:"/order/:id?",controller:"OrderController",controllerAs:"vm",templateUrl:"/orders/print.html",data:{title:"Visualização do Pedido"}})}e.$inject=["$stateProvider"],angular.module("app.orders").config(e)}(),function(){"use strict";function e(o){function n(e){return(e||[]).filter(function(e){return e.quantity})}return{list:function(e){return o.get("/api/orders",e).then(o.handleError)},getDeliveryTime:function(){var e=(new Date).getTime();return{date:new Date(e+3e6),price:5}},normalizeDeliveryDate:function(e){return e?new Date(e):""},getDateOptions:function(){return{formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1,showWeeks:!1}},createOrder:function(e,t,a,r){return e&&(t._customer=e._id,t.customer=e,t.shippingAddress=e.address),t.items=n(a),t.gifts=n(r),t.payment&&"MONEY"!==t.payment.paymentType&&(t.payment.change=null,t.payment.moneyTotal=null),o.post("/api/orders",t).then(o.handleError)}}}e.$inject=["HTTPService"],angular.module("app.orders").factory("OrderService",e)}(),function(){"use strict";function e(a,t,r){var e,o=this,n=a.params.id;return t.endpoint="products",o.product={},o.save=function(e){t.save(e).then(function(e){var t=e.data;201===e.status&&a.go(a.current.name,{id:t._id}),r.success({title:"product",message:"form.saved"})}).catch(r.error)},n&&(e=n,t.byId(e).then(function(e){o.product=e.data}).catch(r.error)),o}e.$inject=["$state","RestService","NotificationService"],angular.module("app.products").controller("ProductController",e)}(),function(){"use strict";function e(e,t,a,r){return r.endpoint="products",angular.extend(this,a("GenericListController",{vm:this,$state:e,$window:t,service:r})),this}e.$inject=["$state","$window","$controller","RestService"],angular.module("app.products").controller("ProductListController",e)}(),function(){"use strict";function e(e){e.state("app.products",{url:"/products?q?page?",controller:"ProductListController",controllerAs:"vm",templateUrl:"/products/list.html",data:{title:"Lista de Produtos"}}).state("app.product",{url:"/product/:id?",controller:"ProductController",controllerAs:"vm",templateUrl:"/products/form.html",data:{title:"Cadastro de Produto"}})}e.$inject=["$stateProvider"],angular.module("app.products").config(e)}(),function(){"use strict";function e(t){return{list:function(e){return t.get("/api/products",e).then(t.handleError)}}}e.$inject=["HTTPService"],angular.module("app.products").factory("ProductService",e)}(),function(){"use strict";function e(a,t,r){var e,o=this,n=a.params.id;return t.endpoint="referencePoints",o.referencePoint={},o.save=function(e){t.save(e).then(function(e){var t=e.data;201===e.status&&a.go(a.current.name,{id:t._id}),r.success({title:"referencePoint",message:"form.saved"})}).catch(r.error)},n&&(e=n,t.byId(e).then(function(e){o.referencePoint=e.data}).catch(r.error)),o}e.$inject=["$state","RestService","NotificationService"],angular.module("app.referencePoints").controller("ReferencePointController",e)}(),function(){"use strict";function e(e,t,a){return a.endpoint="referencePoints",angular.extend(this,t("GenericListController",{vm:this,$state:e,service:a})),this}e.$inject=["$state","$controller","RestService"],angular.module("app.referencePoints").controller("ReferencePointListController",e)}(),function(){"use strict";function e(e){e.state("app.referencePoints",{url:"/referencePoints?q?page?",controller:"ReferencePointListController",controllerAs:"vm",templateUrl:"/referencePoints/list.html",data:{title:"Pontos de Referência"}}).state("app.referencePoint",{url:"/referencePoint/:id?",controller:"ReferencePointController",controllerAs:"vm",templateUrl:"/referencePoints/form.html",data:{title:"Cadastro de Ponto de Ref"}})}e.$inject=["$stateProvider"],angular.module("app.referencePoints").config(e)}();